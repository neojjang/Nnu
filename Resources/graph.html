<!--DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"-->
<!DOCTYPE html>
<html>
 <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Flot Examples</title>
    <link href="layout.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="lib/flot/jquery.js"></script>
    <script language="javascript" type="text/javascript" src="lib/flot/jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="lib/flot/jquery.flot.stack.js"></script>
    <script language="javascript" type="text/javascript" src="lib/flot/jquery.flot.pie.js"></script>
 </head>
    <body>

    <div id="graph" style="width:1000px;height:240px;"></div>
    
    <canvas id="postCanvas" height="10" width="10" style="background: #000080;"></canvas>
	
	<p class="postImage">
	<input type="button" value="Post Image">
    </p>

    <p class="stackControls">
    <input type="button" value="With stacking">
    <input type="button" value="Without stacking">
    </p>
    
    <p class="graphControls">
	<input type="button" value="Bars">
	<input type="button" value="Lines">
	<input type="button" value="Lines with steps">
    </p>
    
    <div id="pieGraph" style="width:240px;height:240px;"></div>

	<script type="text/javascript">
	var meats;
	var vegetables;
	var carbs;
	var days;
	var stack = 0, lines = true, bars = false, steps = false;
	var setting = {
	        series: {
	        	stack: stack,
	            lines: {show:lines, fill:true, steps:steps},
	            bars: {show:bars, barWidth:10}
	            // points: {show:true}
	        },
	        xaxis: {
	            mode:"time",
	            timeformat:"%m/%d",
	            tickSize: [30,"day"]
	        },
	        yaxis: {
	            ticks: 10,
	            min: 0,
	        },
	        grid: {
	            backgroundColor: { colors: ["#fff","#eee"] },
	        }
	};
	
	function plotWithOptions(){
		$.plot(
			$("#graph"),
			[
				{label: "meat", data: meats, color: 1},
				{label: "vegetable", data: vegetables, color: 2},
				{label: "carb", data: carbs, color: 3}
			], 
			setting
		);
	}
	
	$(".stackControls input").click(function (e) {
        e.preventDefault();
        stack = $(this).val() == "With stacking" ? true : null;
        setting.series.stack = stack;
        plotWithOptions();
		// Titanium.App.fireEvent( "webAction", { text: "stack change!" } );
    });
    $(".graphControls input").click(function (e) {
        e.preventDefault();
        bars = $(this).val().indexOf("Bars") != -1;
        lines = $(this).val().indexOf("Lines") != -1;
        steps = $(this).val().indexOf("steps") != -1;
        setting.series.lines.show = lines;
        setting.series.lines.steps = steps;
        setting.series.bars.show = bars;
        plotWithOptions();
		// Titanium.App.fireEvent( "webAction", { text: "style change!" } );
    });
    var postCanvas = document.getElementById('postCanvas');
    $(".postImage input").click(function (e) {
        e.preventDefault();
        var image = postCanvas.toDataURL();
        Titanium.App.fireEvent( "postImage", { image: image } );
    });
    
    var meat_mean;
	var vegetable_mean;
	var carb_mean;
    var pieSetting = {
        series: {
            pie: { 
                show: true,
                radius: 1,
                label: {
                    show: true,
                    radius: 2/3,
                    formatter: function(label, series){
                        return '<div style="font-size:8pt;text-align:center;padding:2px;color:white;">'+label+'<br/>'+Math.round(series.percent)+'%</div>';
                    },
                    threshold: 0.1
                }
            }
        },
        legend: {
            show: false
		}
	}
	function plotPieWithOptions(){
		$.plot(
			$("#pieGraph"),
			[
				{label: "meat", data: meat_mean, color: 1},
				{label: "vegetable", data: vegetable_mean, color: 2},
				{label: "carb", data: carb_mean, color: 3}
			], 
			pieSetting
		);
	}
</script>

 </body>
</html>

	</script>

 </body>
</html>